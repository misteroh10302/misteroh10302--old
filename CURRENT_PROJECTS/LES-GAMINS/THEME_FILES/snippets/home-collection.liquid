{% if settings.home_collection != blank %}
  {% assign collection = collections[settings.home_collection] %}
  {% assign count = collections[settings.home_collection].products_count %}
  {% if collections[settings.home_collection].empty? %}
    {% assign count = 0 %}
  {% endif %}

  {% case count %}
    {% when 1 %}
      {% assign grid_width_large = 'large--one-third push--large--one-third' %}
      {% assign grid_width_medium = 'medium--one-half push--medium--one-quarter' %}
      {% assign grid_width_small = 'small--one-whole' %}
    {% when 2 %}
      {% assign grid_width_large = 'large--one-half' %}
      {% assign grid_width_medium = 'medium--one-half' %}
      {% assign grid_width_small = 'small--one-half' %}
    {% when 3 %}
      {% assign grid_width_large = 'large--one-third' %}
      {% assign grid_width_medium = 'medium--one-third' %}
      {% assign grid_width_small = 'small--one-whole' %}
    {% when 4 %}
      {% assign grid_width_large = 'large--one-quarter' %}
      {% assign grid_width_medium = 'medium--one-half' %}
      {% assign grid_width_small = 'small--one-half' %}
    {% when 5 %}
      {% assign grid_width_large = 'large--one-fifth' %}
      {% assign grid_width_medium = 'medium--one-third' %}
      {% assign grid_width_small = 'small--one-half' %}
    {% when 6 %}
      {% assign grid_width_large = 'large--one-sixth' %}
      {% assign grid_width_medium = 'medium--one-third' %}
      {% assign grid_width_small = 'small--one-half' %}
    {% else %}
      {% assign grid_width_large = {{settings.global_grid_width_large}} %}
      {% assign grid_width_medium = {{settings.global_grid_width_medium}} %}
      {% assign grid_width_small = {{settings.global_grid_width_small}} %}
  {% endcase %}

  <div class="homepage-collection {{ settings.homepage_collection_color }}">

    <div class="wrapper">
      
      <div class="grid-uniform">
                {% unless settings.home_product_one == blank or settings.home_product_one.empty? %}
                  {% assign product = all_products[settings.home_product_one] %}

                  {% if product.template_suffix == "charge-rabbit" %}
                    {% assign form_action = product.metafields.charge_rabbit.subscribe_path %}
                    {% assign form_method = 'get'%}
                    {% assign form_class = "charge-rabbit-product" %}
                    {% assign show_quantity = false %}
                    {% assign include_customer_id = true %}

                    {% include 'membership-product-callbacks' %}
                  {% else %}
                    {% assign form_action = '/cart/add'%}
                    {% assign form_method = 'post'%}
                    {% assign form_id = "AddToCartForm" %}
                    {% assign show_quantity = settings.product_quantity %}
                    {% include 'product-callbacks' %}
                  {% endif %}

                  <div class="homepage-product">
                    {% unless settings.homepage_product_subtitle == '' %}
                      <h4 class="home__subtitle">{{ settings.homepage_product_subtitle}}</h4>
                    {% endunless %}
                    {% include 'product-grid-item' %}
                  </div>
                {% endunless %}

                    {% unless settings.home_product_two == blank or settings.home_product_two.empty? %}
                {% assign product = all_products[settings.home_product_two] %}

                {% if product.template_suffix == "charge-rabbit" %}
                  {% assign form_action = product.metafields.charge_rabbit.subscribe_path %}
                  {% assign form_method = 'get'%}
                  {% assign form_class = "charge-rabbit-product" %}
                  {% assign show_quantity = false %}
                  {% assign include_customer_id = true %}

                  {% include 'membership-product-callbacks' %}
                {% else %}
                  {% assign form_action = '/cart/add'%}
                  {% assign form_method = 'post'%}
                  {% assign form_id = "AddToCartForm" %}
                  {% assign show_quantity = settings.product_quantity %}
                  {% include 'product-callbacks' %}
                {% endif %}

                <div class="homepage-product {{ settings.homepage_product_color }}">
                  {% unless settings.homepage_product_subtitle == '' %}
                    <h4 class="home__subtitle">{{ settings.homepage_product_subtitle}}</h4>
                  {% endunless %}
                  {% include 'product-grid-item' %}
                </div>
              {% endunless %}

              {% unless settings.home_product_three == blank or settings.home_product_three.empty? %}
                {% assign product = all_products[settings.home_product_three] %}

                {% if product.template_suffix == "charge-rabbit" %}
                  {% assign form_action = product.metafields.charge_rabbit.subscribe_path %}
                  {% assign form_method = 'get'%}
                  {% assign form_class = "charge-rabbit-product" %}
                  {% assign show_quantity = false %}
                  {% assign include_customer_id = true %}

                  {% include 'membership-product-callbacks' %}
                {% else %}
                  {% assign form_action = '/cart/add'%}
                  {% assign form_method = 'post'%}
                  {% assign form_id = "AddToCartForm" %}
                  {% assign show_quantity = settings.product_quantity %}
                  {% include 'product-callbacks' %}
                {% endif %}

                <div class="homepage-product {{ settings.homepage_product_color }}">
                  {% unless settings.homepage_product_subtitle == '' %}
                    <h4 class="home__subtitle">{{ settings.homepage_product_subtitle}}</h4>
                  {% endunless %}
                  {% include 'product-grid-item' %}
                </div>
              {% endunless %}
          </div>
    </div>
  </div>
{% endif %}